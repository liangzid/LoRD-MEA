#+title: Experiments of generalized training.
#+date: Fri Apr 26 11:18:34 2024
#+author: Zi Liang
#+email: zi1415926.liang@connect.polyu.hk
#+latex_class: elegantpaper
#+filetags: :exper:research:coding:


I make sure:

1. Complex-LoRD doesn't work well.
2. LoRD-IV doesn't work well.

** Evaluate on PIQA

*** Short text

<This results is generated by bad serialization>

|-------------------------------+---------+--------+--------|
| method                        | dataset |    acc | strerr |
|-------------------------------+---------+--------+--------|
| llama3-8B (init model)        | piqa    | 0.7824 | 0.0096 |
|-------------------------------+---------+--------+--------|
| CE w. bug                     | piqa    | 0.7949 | 0.0094 |
| CE w.o. bug                   | piqa    | 0.7802 | 0.0097 |
|-------------------------------+---------+--------+--------|
| lordii w. bug                 | piqa    | 0.7900 | 0.0095 |
| lordii w.o. bug               | piqa    | 0.7971 | 0.0094 |
|-------------------------------+---------+--------+--------|
| lordii w.o. bug (new) epoch2  | piqa    | 0.7943 | 0.0094 |
| lordii w.o. bug (new) epoch5  | piqa    | 0.8020 | 0.0093 |
| lordii w.o. bug (new) epoch8  | piqa    | 0.7971 | 0.0094 |
| lordii w.o. bug (new) epoch11 | piqa    | 0.7960 | 0.0094 |
|-------------------------------+---------+--------+--------|
| lordii long sample epoch3     | piqa    | 0.7862 | 0.0096 |
| complex-lord                  | piqa    | 0.7731 | 0.0098 |
| claude3 (victim model)        | -       |      - |      - |
|-------------------------------+---------+--------+--------|
| lord-v epoch2                 | piqa    | 0.7922 | 0.0095 |
| lord-v epoch5                 | piqa    | 0.7916 | 0.0095 |
| lord-v epoch8                 | piqa    | 0.7851 | 0.0096 |
| lord-v epoch11                | piqa    | 0.7916 | 0.0095 |
| lord-v epoch14                | piqa    | 0.7916 | 0.0095 |
|-------------------------------+---------+--------+--------|
| lord-vi epoch2 (w. bug)       | piqa    | 0.7916 | 0.0095 |
| lord-vi epoch5  (w. bug)      | piqa    | 0.7938 | 0.0094 |
| lord-vi epoch8  (w. bug)      | piqa    | 0.7911 | 0.0095 |
| lord-vi epoch11  (w. bug)     | piqa    | 0.7954 | 0.0094 |
| lord-vi epoch14  (w. bug)     | piqa    | 0.7971 | 0.0094 |
|-------------------------------+---------+--------+--------|
| lord-VI epoch2 w.o. bug       | piqa    | 0.7933 | 0.0094 |
| lord-VI epoch5 w.o. bug       | piqa    | 0.7878 | 0.0095 |
| lord-VI epoch8 w.o. bug       | piqa    | 0.7835 | 0.0096 |
| lord-VI epoch11 w.o. bug      | piqa    | 0.7769 | 0.0097 |
| lord-VI epoch14 w.o. bug      | piqa    | 0.7791 | 0.0097 |
|-------------------------------+---------+--------+--------|
| lord-VI epoch2 w.o. bug       | piqa    | 0.7916 | 0.0095 |
| lord-VI epoch5 w.o. bug       | piqa    | 0.7960 | 0.0094 |
| lord-VI epoch8 w.o. bug       | piqa    | 0.7867 | 0.0096 |
| lord-VI epoch11 w.o. bug      | piqa    | 0.7943 | 0.0094 |
| lord-VI epoch14 w.o. bug      | piqa    | 0.7807 | 0.0097 |
|                               |         |        |        |


|----------------+---------------+-------+--------|
| method         | task          |   acc |  sterr |
|----------------+---------------+-------+--------|
| vanilla w. bug | winogrande    | 0.729 | 0.0125 |
| vanilla w. bug | piqa          | 0.796 | 0.0094 |
| vanilla w. bug | openbookqa    | 0.364 | 0.0215 |
| vanilla w. bug | hellaswag     | 0.603 | 0.0049 |
| vanilla w. bug | boolq         | 0.832 | 0.0065 |
| vanilla w. bug | arc_easy      | 0.822 | 0.0078 |
| vanilla w. bug | arc_challenge | 0.503 | 0.0145 |
|----------------+---------------+-------+--------|

Results of the llama3-8B model:

|---------------+---------+--------+--------+----------+--------+---+--------|
| Tasks         | Version | Filter | n-shot | Metric   |  Value |   | Stderr |
|---------------+---------+--------+--------+----------+--------+---+--------|
| winogrande    |       1 | none   |      0 | acc      | 0.7190 | ±  | 0.0126 |
| piqa          |       1 | none   |      0 | acc      | 0.7862 | ±  | 0.0096 |
|               |         | none   |      0 | acc_norm | 0.7867 | ±  | 0.0096 |
| openbookqa    |       1 | none   |      0 | acc      | 0.3380 | ±  | 0.0212 |
|               |         | none   |      0 | acc_norm | 0.4280 | ±  | 0.0221 |
| hellaswag     |       1 | none   |      0 | acc      | 0.5771 | ±  | 0.0049 |
|               |         | none   |      0 | acc_norm | 0.7581 | ±  | 0.0043 |
| boolq         |       2 | none   |      0 | acc      | 0.8312 | ±  | 0.0066 |
| arc_easy      |       1 | none   |      0 | acc      | 0.8144 | ±  | 0.0080 |
|               |         | none   |      0 | acc_norm | 0.7955 | ±  | 0.0083 |
| arc_challenge |       1 | none   |      0 | acc      | 0.5290 | ±  | 0.0146 |
|               |         | none   |      0 | acc_norm | 0.5674 | ±  | 0.0145 |
|---------------+---------+--------+--------+----------+--------+---+--------|


Results of our checkpoint:


*** Long text (chat 3.3k)


|-----------+---------+--------+--------|
| m         | dataset | acc    | strerr |
|-----------+---------+--------+--------|
| llama3-8B | piqa    | 0.7824 | 0.0096 |
| lordii    | piqa    | -      | -      |
| lordiv    | piqa    | -      | -      |
| vanilla   | piqa    | -      | -      |
| claude3   | -       | -      | -      |
|-----------+---------+--------+--------|


** RUNNING TABLE


|---------+----------+------------------------|
| sever   | filename | task                   |
|---------+----------+------------------------|
| 226 0,1,2 | 1.1.0428 | 16 subset, new method, no early shut |
| 226 4,5,6 | 1.1.0428 | 64 subset, new method, no early shut |
|---------+----------+------------------------|


